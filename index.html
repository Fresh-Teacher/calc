<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fullscreen Video Calculator</title>
    <style>
        :root {
    --button-opacity: 0.1;
    --button-hover-opacity: 0.2;
    --operator-color: 255, 105, 180;
    --equals-color: 50, 205, 50;
    --clear-color: 255, 69, 0;
    --ripple-color: rgba(255, 255, 255, 0.7);
    --calculator-width: min(95vw, 400px);
    --calculator-padding: 20px;
    --border-radius: 30px;
    --primary-color: #4A235A;
    --secondary-color: #1A5276;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    touch-action: none;
}

html, body {
    height: 100%;
    overflow: hidden;
    position: fixed;
    width: 100%;
    font-size: 16px;
    background-color: #000;
}

body {
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Comic Sans MS', cursive, sans-serif;
}

.calculator-container {
    position: relative;
    width: var(--calculator-width);
    max-height: 90vh;
    aspect-ratio: 3/4;
    border-radius: var(--border-radius);
    background: linear-gradient(145deg, var(--primary-color), var(--secondary-color));
    box-shadow: 
        20px 20px 60px rgba(0, 0, 0, 0.5),
        -20px -20px 60px rgba(255, 255, 255, 0.1),
        inset 5px 5px 20px rgba(255, 255, 255, 0.1),
        inset -5px -5px 15px rgba(0, 0, 0, 0.3);
    padding: var(--calculator-padding);
    overflow: hidden;
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.calculator-brand {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    color: #fff;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    font-size: 1.2rem;
    font-weight: bold;
    z-index: 2;
}

.calculator-decoration {
    position: absolute;
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.6);
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}

.decoration-1 { top: 45px; left: 20px; }
.decoration-2 { top: 45px; right: 20px; }
.decoration-3 { bottom: 20px; left: 20px; }
.decoration-4 { bottom: 20px; right: 20px; }

.solar-panel {
    position: absolute;
    top: 15px;
    right: 30px;
    width: 80px;
    height: 20px;
    background: linear-gradient(45deg, #1a1a1a, #2c3e50);
    border-radius: 3px;
    display: flex;
    gap: 2px;
    padding: 2px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.solar-cell {
    flex: 1;
    background: rgba(52, 152, 219, 0.3);
    border-radius: 1px;
}

.calculator {
    height: 100%;
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 20px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: calc(var(--border-radius) - 10px);
    padding: 15px;
    box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.3);
}

.display {
    width: 100%;
    height: 80px;
    font-size: 2.5rem;
    text-align: right;
    padding: 10px 20px;
    margin-bottom: 10px;
    border: none;
    background: linear-gradient(145deg, #2C3E50, #34495E);
    color: #4CAF50;
    border-radius: 15px;
    box-shadow: 
        inset 2px 2px 5px rgba(0, 0, 0, 0.5),
        inset -2px -2px 5px rgba(255, 255, 255, 0.1);
    font-family: 'Digital-7', 'Comic Sans MS', cursive;
    text-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
}

.buttons {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    flex-grow: 1;
}

.button {
    position: relative;
    overflow: hidden;
    font-size: 1.5rem;
    border: none;
    border-radius: 15px;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 
        5px 5px 10px rgba(0, 0, 0, 0.3),
        -5px -5px 10px rgba(255, 255, 255, 0.1);
    font-family: 'Comic Sans MS', cursive;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    min-height: 60px;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
}

.button:not(.button--operator):not(.button--equals):not(.button--clear) {
    background: linear-gradient(145deg, #6C3483, #5B2C6F);
}

.button--operator {
    background: linear-gradient(145deg, #C71585, #8B0A50);
    font-weight: bold;
}

.button--equals {
    background: linear-gradient(145deg, #27AE60, #196F3D);
    font-weight: bold;
}

.button--clear {
    background: linear-gradient(145deg, #E74C3C, #A93226);
    font-weight: bold;
}

.button:hover {
    background-color: rgba(255, 255, 255, var(--button-hover-opacity));
}

.button:active {
    transform: scale(0.95);
}

.ripple {
    position: absolute;
    border-radius: 50%;
    background-color: var(--ripple-color);
    transform: scale(0);
    animation: ripple 0.6s linear;
    pointer-events: none;
}

.button-press {
    animation: buttonPress 0.15s ease-in-out;
}

.success-flash {
    animation: successFlash 0.3s ease-out;
}

.error-flash {
    animation: errorFlash 0.3s ease-out;
}

@keyframes ripple {
    to {
        transform: scale(4);
        opacity: 0;
    }
}

@keyframes buttonPress {
    0% { transform: scale(1); }
    50% { transform: scale(0.95); }
    100% { transform: scale(1); }
}

@keyframes successFlash {
    0% { background-color: rgba(76, 175, 80, 0.5); }
    100% { background-color: rgba(255, 255, 255, var(--button-opacity)); }
}

@keyframes errorFlash {
    0% { background-color: rgba(244, 67, 54, 0.5); }
    100% { background-color: rgba(255, 255, 255, var(--button-opacity)); }
}

@media (max-width: 480px) {
    .calculator-container {
        width: 95vw;
        height: auto;
        aspect-ratio: 2/3;
        border-radius: 0;
    }

    .display {
        height: 60px;
        font-size: 2rem;
    }

    .button {
        font-size: 1.2rem;
        min-height: 50px;
    }

    .calculator-brand {
        font-size: 1rem;
    }

    .calculator-decoration {
        font-size: 0.7rem;
    }
}

@supports (-webkit-touch-callout: none) {
    .button {
        padding: 0;
    }
    
    .display {
        font-size: clamp(1.5rem, 4vh, 3rem);
    }
}
    </style>
</head>
<body>
    <div class="calculator-container">
        <video 
            class="background-video"
            id="backgroundVideo"
            playsinline 
            webkit-playsinline 
            autoplay 
            muted 
            loop 
            preload="auto"
            poster="https://avatars.githubusercontent.com/u/98003374?s=400&u=5ccc30b4201d7fb41b12ce2e79981ec475bd7d13&v=4">
            <source src="background.mp4" type="video/mp4">
        </video>
        <div class="calculator">
            <input type="text" class="display" id="display" readonly>
            <div class="buttons">
                <button class="button button--clear" data-action="clear">AC</button>
                <button class="button button--operator" data-action="delete">DEL</button>
                <button class="button button--operator" data-action="percentage">%</button>
                <button class="button button--operator" data-action="operator">/</button>
                <button class="button" data-digit="7">7</button>
                <button class="button" data-digit="8">8</button>
                <button class="button" data-digit="9">9</button>
                <button class="button button--operator" data-action="operator">*</button>
                <button class="button" data-digit="4">4</button>
                <button class="button" data-digit="5">5</button>
                <button class="button" data-digit="6">6</button>
                <button class="button button--operator" data-action="operator">-</button>
                <button class="button" data-digit="1">1</button>
                <button class="button" data-digit="2">2</button>
                <button class="button" data-digit="3">3</button>
                <button class="button button--operator" data-action="operator">+</button>
                <button class="button" data-digit="0">0</button>
                <button class="button" data-digit="00">00</button>
                <button class="button" data-digit=".">.</button>
                <button class="button button--equals" data-action="calculate">=</button>
            </div>
        </div>
    </div>
    <script>
        class SoundManager {
            constructor() {
                this.context = null;
                this.initAudioContext();
            }

            initAudioContext() {
                try {
                    const AudioContext = window.AudioContext || window.webkitAudioContext;
                    this.context = new AudioContext();
                } catch (error) {
                    console.warn('Web Audio API not supported:', error);
                }
            }

            playTone(frequency = 440, duration = 0.1, type = 'sine') {
                if (!this.context) return;
                
                const oscillator = this.context.createOscillator();
                const gainNode = this.context.createGain();
                
                oscillator.type = type;
                oscillator.frequency.setValueAtTime(frequency, this.context.currentTime);
                
                gainNode.gain.setValueAtTime(0.1, this.context.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, this.context.currentTime + duration);
                
                oscillator.connect(gainNode);
                gainNode.connect(this.context.destination);
                
                oscillator.start();
                oscillator.stop(this.context.currentTime + duration);
            }

            playDigitSound() {
                this.playTone(440, 0.1, 'sine');
            }

            playOperatorSound() {
                this.playTone(550, 0.15, 'triangle');
            }

            playEqualsSound() {
                this.playTone(660, 0.2, 'square');
            }

            playErrorSound() {
                this.playTone(220, 0.3, 'sawtooth');
            }
        }

        class EffectsManager {
            static addRipple(element, event) {
                const rect = element.getBoundingClientRect();
                const size = Math.max(rect.width, rect.height);
                const x = event.touches ? event.touches[0].clientX - rect.left : event.clientX - rect.left;
                const y = event.touches ? event.touches[0].clientY - rect.top : event.clientY - rect.top;

                const ripple = document.createElement('span');
                ripple.className = 'ripple';
                ripple.style.width = ripple.style.height = `${size}px`;
                ripple.style.left = `${x - size/2}px`;
                ripple.style.top = `${y - size/2}px`;

                element.appendChild(ripple);
                ripple.addEventListener('animationend', () => ripple.remove());
            }

            static addButtonPress(element) {
                element.classList.add('button-press');
                element.addEventListener('animationend', () => {
                    element.classList.remove('button-press');
                }, { once: true });
            }

            static flashDisplay(element, type = 'success') {
                element.classList.add(`${type}-flash`);
                element.addEventListener('animationend', () => {
                    element.classList.remove(`${type}-flash`);
                }, { once: true });
            }
        }

        class Calculator {
            constructor(displayElement, soundManager) {
                this.displayElement = displayElement;
                this.soundManager = soundManager;
                this.displayValue = '';
                this.lastOperator = null;
                this.lastNumber = null;
                this.newNumberStarted = false;
            }

            appendDigit(digit) {
                if (this.newNumberStarted) {
                    this.displayValue = '';
                    this.newNumberStarted = false;
                }
                
                if (digit === '.' && this.displayValue.includes('.')) {
                    this.soundManager.playErrorSound();
                    return;
                }
                
                this.soundManager.playDigitSound();
                this.displayValue += digit;
                this.updateDisplay();
            }

            handleOperator(operator) {
                if (this.displayValue === '') return;
                
                this.soundManager.playOperatorSound();
                
                if (this.lastOperator && !this.newNumberStarted) {
                    this.calculate();
                }
                
                this.lastOperator = operator;
                this.lastNumber = parseFloat(this.displayValue);
                this.newNumberStarted = true;
            }

            calculate() {
                if (this.lastOperator === null || this.newNumberStarted) return;

                const currentNumber = parseFloat(this.displayValue);
                let result;

                switch (this.lastOperator) {
                    case '+':
                        result = this.lastNumber + currentNumber;
                        break;
                    case '-':
                        result = this.lastNumber - currentNumber;
                        break;
                    case '*':
                        result = this.lastNumber * currentNumber;
                        break;
                    case '/':
                        if (currentNumber === 0) {
                            this.displayError();
                            return;
                        }
                        result = this.lastNumber / currentNumber;
                        break;
                    default:
                        return;
                }

                this.soundManager.playEqualsSound();
                this.displayValue = this.formatResult(result);
                this.lastOperator = null;
                this.updateDisplay();
                this.newNumberStarted = true;
                EffectsManager.flashDisplay(this.displayElement, 'success');
            }

            calculatePercentage() {
                if (this.displayValue === '') return;
                const value = parseFloat(this.displayValue) / 100;
                this.displayValue = this.formatResult(value);
                this.updateDisplay();
            }

            clear() {
                this.displayValue = '';
                this.lastOperator = null;
                this.lastNumber = null;
                this.newNumberStarted = false;
                this.updateDisplay();
            }

            delete() {
                this.displayValue = this.displayValue.slice(0, -1);
                this.updateDisplay();
            }

            formatResult(number) {
                if (isNaN(number) || !isFinite(number)) {
                    return 'Error';
                }
                return number.toString().slice(0, 12);
            }

            displayError() {
                this.soundManager.playErrorSound();
                this.displayValue = 'Error';
                this.updateDisplay();
                this.lastOperator = null;
                this.lastNumber = null;
                this.newNumberStarted = true;
                EffectsManager.flashDisplay(this.displayElement, 'error');
            }

            updateDisplay() {
                this.displayElement.value = this.displayValue;
            }
        }

        class VideoManager {
            constructor(videoElement) {
                this.videoElement = videoElement;
                this.initializeVideo();
            }

            initializeVideo() {
                this.handleVisibilityChange = () => {
                    document.hidden ? this.videoElement.pause() : this.playVideo();
                };

                document.addEventListener('visibilitychange', this.handleVisibilityChange);
                document.body.addEventListener('touchstart', () => this.playVideo(), { once: true });
                
                this.playVideo();
            }

            async playVideo() {
                try {
                    await this.videoElement.play();
                } catch (error) {
                    console.warn('Video playback failed:', error);
                }
            }
        }

        // Initialize application
        document.addEventListener('DOMContentLoaded', () => {
            const soundManager = new SoundManager();
            const calculator = new Calculator(document.getElementById('display'), soundManager);
            new VideoManager(document.getElementById('backgroundVideo'));

            // Event delegation for calculator buttons
            document.querySelector('.buttons').addEventListener('click', (event) => {
                const button = event.target;
                if (!button.matches('button')) return;

                EffectsManager.addRipple(button, event);
                EffectsManager.addButtonPress(button);

                if (button.dataset.digit) {
                    calculator.appendDigit(button.dataset.digit);
                } else if (button.dataset.action) {
                    switch (button.dataset.action) {
                        case 'operator':
                            calculator.handleOperator(button.textContent);
                            break;
                        case 'calculate':
                            calculator.calculate();
                            break;
                        case 'clear':
                            calculator.clear();
                            soundManager.playOperatorSound();
                            break;
                        case 'delete':
                            calculator.delete();
                            soundManager.playOperatorSound();
                            break;
                        case 'percentage':
                            calculator.calculatePercentage();
                            soundManager.playOperatorSound();
                            break;
                    }
                }
            });

            // Prevent default touch behaviors
            const preventDefaultTouch = (event) => event.preventDefault();
            
            document.addEventListener('touchmove', preventDefaultTouch, { passive: false });
            document.addEventListener('gesturestart', preventDefaultTouch, { passive: false });
            
            let lastTouchEnd = 0;
            document.addEventListener('touchend', (event) => {
                const now = Date.now();
                if (now - lastTouchEnd <= 300) {
                    event.preventDefault();
                }
                lastTouchEnd = now;
            }, { passive: false });
        });
    </script>
</body>
</html>
